;; -*- mode: lisp; syntax: common-lisp; -*-

(in-package "EGLEIS")

(defvar *high-volume-shops* '("Lululalaland"
                                "doubleangeldesign"
                                "yadanabeads"
                                "thebeadyeye"
                                "artfulmarket"
                                "blacksheepbeads"
                                "craftisland"
                                "beadsupplies"
                                "prodigalprogeny"
                                "Cathysjewels"
                                "EpochBeads"
                                "FromJapanWithLove"
                                "TheBlackApple"
                                "MKSupplies"
                                "atomicveggiecom"
                                "fabricsupplies"
                                "shareliving"
                                "mountainshadowdesign"
                                "JLeeBeads"
                                "BobbiThisnThat"
                                "dennisanderson"
                                "cathydailey"
                                "GemmeTresor"
                                "HomeStudio"
                                "norah62"
                                "Sunyno"
                                "PatinaQueen"
                                "GudonyaToo"
                                "a2zDesigns"
                                "simplymetal"
                                "alittlegoodness"
                                "bellabohemian"
                                "savor"
                                "sunshinebuttercup"
                                "littleputbooks"
                                "CozyMoments"
                                "MadisonCraftStudio"
                                "niklindesigns1225"
                                "luxedeluxe"
                                "santabarbaradesigns"
                                "spiritgirl"
                                "piddix"
                                "sweetheartsinner"
                                "everyjotandtittle"
                                "daisycakessoap"
                                "WinterRoseDesigns"
                                "AshleyG"
                                "goshen"
                                "thedespinacollection"
                                "tinymeat"
                                "SunAndMoonCraftKits"
                                "knottybabywear"
                                "jingjingdesign"
                                "dimestoreemporium"
                                "fategoddess"
                                "luckykaerufabric"
                                "elles"
                                "JapanKawaiiYa"
                                "cOveTableCuriOsitIEs"
                                "FearlessFibers"
                                "berkleyillustration"
                                "jlyndesigns"
                                "jwlrysupply"
                                "VintageBeadShop"
                                "AmyGaines"
                                "BrassBouquet"
                                "StudioSen"
                                "BellaNoelle"
                                "FatDaddyBakeShop"
                                "GreenThumbDesigns"
                                "Charms4Design"
                                "birdzNbeez"
                                "LillysBeadBox"
                                "BlueLadore"
                                "norajane"
                                "thedogcoatlady"
                                "bluebirdlane"
                                "Charmerz"
                                "nightstar"
                                "terbearco"
                                "janinekingdesigns"
                                "AnnieHowes"
                                "pacokeco"
                                "theEvolPixiesSupply"
                                "adorapop"
                                "GlassSupplies"
                                "thatsmycharm"
                                "urbanrose"
                                "circularaccessories"
                                "BlueBirdSupplyCo"
                                "pomadour24"
                                "dangsworld"
                                "caughtredhanded"
                                "Matatabi"
                                "halolo"
                                "jewelrydepot"
                                "CardBlanc"
                                "Ahpeele"
                                "Tulle"
                                "BestBeads"
                                "phenomenon1859"
                                "FabBeads"
                                "Gudonya"
                                "schOOLLOcker"
                                "YouStinkSoap"
                                "belleandboo"
                                "esdesigns"
                                "EurekaEureka"
                                "LingGlass"
                                "thienthanh"
                                "PandorasBeadBox"
                                "fabricworm"
                                "rufusandroxy"
                                "anapaulaoli"
                                "pdxbeanies"
                                "KungFuCowgirl"
                                "bazaarLatino"
                                "E2SSupplies"
                                "oliviamoon"
                                "sweetpaperie"
                                "trimweaver"
                                "mincingmockingbird"
                                "fabricshoppe"
                                "RJbeads"
                                "treehouse28"
                                "hansigurumi"
                                "simbiosisbyjulia"
                                "allysonhill"
                                "TammysTreasures"
                                "Elephannie"
                                "allisonstrine"
                                "magnoliasupplie"
                                "monkeyshines"
                                "thelovelyteaspoon"
                                "sylver"
                                "Tobysmom"
                                "solivio"
                                "SweetGeorgiaBeads"
                                "nicholasandfelice"
                                "karaku"
                                "GSboutique"
                                "beadbargains"
                                "paraphernalia"
                                "SpaTherapy"
                                "superflykidz"
                                "porkchopshow"
                                "sweetflavor"
                                "PiecesOfMePendants"
                                "sfgirlbybay"
                                "tigerlillyshop"
                                "AlwaysAmy"
                                "timberps"
                                "deby0"
                                "fancyfeast"
                                "oneripepeach"
                                "photoglassworks"
                                "madcitysue"
                                "caramelos"
                                "gemmafactrix"
                                "thecharmlady"
                                "time2cre8"
                                "byjanelle"
                                "sudlow"
                                "toybreaker"
                                "thebeadingtree"
                                "palomasnest"
                                "deejann"
                                "sleepingdogstudio"
                                "BrambleberryLane"
                                "akaLulaBeads"
                                "CraftySupplies"
                                "DressGreen"
                                "johnwgolden"
                                "missficklemedia"
                                "PeppermintSoda"
                                "PinkBirdBeads"
                                "Sheltie19"
                                "MimiLoLo"
                                "loop"
                                "ohmymilky"
                                "Zivile"
                                "ItsAllAboutThePrint"
                                "misssapporo"
                                "puffluna"
                                "Boojiboo"
                                "IsabellaSupplies"
                                "heatherknitz"
                                "crochetroo"
                                "Beads2string"
                                "brassgoldbeads"
                                "beadbrats"
                                "ImagesUnderGlass"
                                "4Jess"
                                "Deadworry"
                                "Eolith"
                                "dazeychic"
                                "yuhandmade"
                                "soap"
                                "TheCraftyDragonfly"
                                "magymai711"
                                "gorjuss"
                                "strawberryfizz"
                                "SeeJayneKnitYarns"
                                "Stoned"
                                "ilee"
                                "BarrelOfMonkeys"
                                "JemsGems"
                                "AnomalousBits"
                                "shop66"
                                "jimmypickles"
                                "Saucylouise"
                                "pinkytoast"
                                "pigeonroofstudios"
                                "fivesisters"
                                "woolpets"
                                "FabBeads"
                                "Analiese"
                                "BeadersBoutique"
                                "charmsgalore"
                                "joom"
                                "KeysandMemories"
                                "moriam87"
                                "ccvalenzo"
                                "cornerstore"
                                "DornickDesigns"
                                "downshadowlane"
                                "JewelrySuppliesEtc"
                                "Lollibomb"
                                "marymarsh"
                                "pinkquartzminerals"
                                "ragtrader"
                                "sugarloop"
                                "surprisesupplies"
                                "apak"
                                "CarolLeeDesigns"
                                "CharmerzII"
                                "copperpot"
                                "creativepapertrail"
                                "dillondesigns"
                                "ERMoriginals"
                                "Haunt"
                                "holly"
                                "ImagineArt7"
                                "KathrynRiechert"
                                "littlebluebirdstudios"
                                "LoveLeeSoaps"
                                "MATTY8080"
                                "OleBagLady"
                                "pandabeads"
                                "rainbowswirlz"
                                "redcrowarts"
                                "relishdress"
                                "sewlovefabrics"
                                "starlitnest"
                                "thefairypixel"
                                "TrendySupplier"
                                "VintageNecessities"
                                "aromaticbodyoils"
                                "catdancingranch"
                                "cottonblue"
                                "crystalsbythepiece"
                                "elsiecake"
                                "gamiworks"
                                "imyourpresent"
                                "kittycrossbones"
                                "marsdesign"
                                "olay"
                                "onedollarjewelry"
                                "phoebestreasure"
                                "stilettoheights"
                                "yukidesigns"
                                "yummytreasures"
                                "elladean"
                                "babypop"
                                "BathLife"
                                "BirdNerd"
                                "BitofWhimsyPrims"
                                "casbeads"
                                "charmsnfindings"
                                "cottagegardentherapi"
                                "FatCatKnits"
                                "lindatrent"
                                "mermaidsdowry"
                                "MyHeartandSew"
                                "silverminejewelry"
                                "smilingfrogs"
                                "stdymphnasupplies"
                                "stevester"
                                "surly"
                                "squidglass"
                                "Tomorrowsunknown"
                                "zombiesunite"
                                "1ofmykind"
                                "angrybunny"
                                "flameworks"
                                "geelizzie"
                                "gypsyspiritstudio"
                                "kristieskids"
                                "labeadsupply"
                                "littleappleton"
                                "maxandbella"
                                "NeedleNoodles"
                                "pinkgrapefruitstyle"
                                "rosalyndesigns"
                                "starrydesigns"
                                "TillyBloom"
                                "6060"
                                "AboveAllFabric"
                                "AliciaBock"
                                "BurntCookie"
                                "candyconnection22"
                                "CheapBoutique"
                                "cottagegardentherapi"
                                "digitalpaperie"
                                "JPATPURSES"
                                "jennifersjewels"
                                "kateblack"
                                "MiaBeads"
                                "sakurakittycreatives"
                                "UncommonBeads"
                                "dara43"
                                "vital"
                                "windspirit"
                                "boxesnbeads"
                                "yumiyumi"
                                "SavenSense"
                                "DogboneArt"
                                "EtsyLabs"
                                "greenchairpress"
                                "johnclark"
                                "JustJaynes"
                                "naiad"
                                "SuppliesToGo"
                                "sushipot"
                                "acrylicana"
                                "gypsywoman"
                                "CaladoniaMarch"
                                "glittercritter"
                                "kellydesigns4u"
                                "thegraphicmime"
                                "thevintagevault"
                                "BeadsYouNeed"
                                "bethanycooper"
                                "catylouquilts"
                                "EnchantingBeads"
                                "EnfinLaVoila"
                                "gomeagan"
                                "HummingbirdEyes"
                                "jackandjane"
                                "janesays"
                                "kristenskrafts"
                                "littlebitfunky"
                                "luchaworkshop"
                                "MixologyMakeup"
                                "owlishly"
                                "QualyBeads"
                                "RobinsEggBlue"
                                "roseofsharonacres"
                                "sarahjanestudios"
                                "SUAY"
                                "thepebblecollection"
                                "thisgalissewcrazy"
                                "penorus"
                                "WoodcraftsandCandles"
                                "yellena"
                                "kateszabone"
                                "ohcrop16"
                                "patternmania"
                                "ButtonBoutique"
                                "buttonempire"
                                "chinacherie"
                                "bluemarblebeads"
                                "LisasLovlies"
                                "snapcrafty"
                                "2BCreative"
                                "RayDichroic"
                                "robotcandy"
                                "keykalou"
                                "LittlebeaneBoutique"
                                "rosemarybeads"
                                "littlebrownpen"
                                "lunasilver"
                                "sultryaffairbeads"
                                "TheFlyingEwe"
                                "ChristineRenee"
                                "contrary"
                                "patternshop"
                                "shell3409"
                                "annacote"
                                "charmparfait"
                                "ayelet17"
                                "Corrabelle"
                                "MichelleBrusegaard"
                                "BluLima"
                                "cutecumber"
                                "umecrafts"
                                "irenesuchocki"
                                "ubbbusiness"
                                "jessejanes"
                                "veryvintage"
                                "mineymo"
                                "ellielantern"
                                "bellaserababy"
                                "carlasonheim"
                                "ArtisticEphemera"
                                "chocolateswirl"
                                "elloh"
                                "fuzzymitten"
                                "jeanettejed"
                                "ThePeach"
                                "Briesboutique"
                                "bluhealer"
                                "craftpudding"
                                "artandghosts"
                                "Retronana"
                                "enchantedknoll"
                                "lillyella"
                                "Muyinmolly"
                                "TheLooks"
                                "BargainHeadbands"
                                "Earmark"
                                "buggabugs"
                                "fluffington"
                                "cjsdesigns"
                                "jocalatte"
                                "lassiegirl"
                                "matteart"
                                "emilyparson"
                                "dkim"
                                "sakurafabric"
                                "CreativeElements"
                                "allegrae"
                                "bibbidibaubles"
                                "pinkee"
                                "pinksupply"
                                "tinaseamonster"
                                "lustrousthings"
                                "thnkdfrent"
                                "mixbaby"
                                "magichands"
                                "boygirlparty"
                                "kellyrae"
                                "dogartstudio"
                                "Loosebeadshop"
                                "Gems4us"
                                "knotartoverstok"
                                "Beadaholique"
                                "lizmiera"
                                "ohmycavalier"
                                "karenssoaps"
                                "kaylah7"
                                "allthingsbeaded"
                                "CandylandBeads"
                                "countryheartgifts"
                                "eandebungalow"
                                "4thAveSoapCo"
                                "designsbyappletree"
                                "Buttonsgalore"
                                "kendrabinney"
                                "nestlings"
                                "originalfindings"
                                "DorisDotz"
                                "weeones"
                                "PinkyNoodles"
                                "cmyk"
                                "dkKnits"
                                "ellynelly"
                                "estatesaletreasures"
                                "ollieandjo"
                                "pickypicky"
                                "soapdeli"
                                "isotope"
                                "stoopidgerl"
                                "WanWanCorner"
                                "PenGwynneBeads"
                                "MommieMadeIt"
                                "portobello"
                                "SugarChicBaby"
                                "saritasupplies"
                                "jelene"
                                "maryandjane"
                                "rockcandybeadstudio"
                                "StarofSupplies"
                                "beautifulwork"
                                "galongefindings"
                                "liskidder"
                                "accessoryalamode"
                                "DeliciousCrochet"
                                "JewelsByNature"
                                "beesquarefabrics"
                                "charmdesign"
                                "bluedogrose"
                                "greenjelly"
                                "hollyhawk"
                                "bostonbaglady"
                                "luckyfiona"
                                "vedabliss"
                                "wiggleperfume"
                                "CuteAbility"
                                "mamacitabeadworks"
                                "Na0sGlass"
                                "juliepersons"
                                "BoutiqueMia"
                                "EPICJEWELRY"
                                "hiddenhaven"
                                "amyelisedesigns"
                                "busybaprons"
                                "paperstreet"
                                "DIYStash"
                                "momomadeit"
                                "yarnchef"
                                "lilikoidesign"
                                "luccicare"
                                "PassionFruits"
                                "Moop"
                                "vintaj"
                                "ymbd"
                                "Ruthscrafts"
                                "butterflygirldesigns"
                                "creativethursday"
                                "KFcollection"
                                "Lizix26"
                                "Thompsondesigns"
                                "spindlecatstudio"
                                "Twistedstring"
                                "weekendjewelry1"
                                "classycastle"
                                "youngmoustache"
                                "yarnpirate"
                                "WistfulSupplies"
                                "willowglass"
                                "wicopy"
                                "whimsiedots"
                                "spidercamp"
                                "robandlean"
                                "rarrarpress"
                                "pixelbypixel"
                                "muttsywonder"
                                "Mugsysbeads"
                                "Lunagirl"
                                "maryink"
                                "LisaEverettDesigns"
                                "LilyBaySoap"
                                "LiiLii"
                                "katrinakaye"
                                "jeanettejed"
                                "helloberlin"
                                "GalsWithGirls"
                                "foundling"
                                "DownToTheWireDesigns"
                                "chainchainchained"
                                "BirkaScandinavian"
                                "BlackStarBeads"
                                "BeadNeeds"
                                "ArchipelagoArts"
                                "1AEON"
                                "mylavaliere"
                                "artbyheathersupplies"
                                "supastarr"
                                "BAYMOONSTUDIO"
                                "DaisyChains"
                                "bluedaisy1222"
                                "mintconspiracy"
                                "GeekGear"
                                "hobbledehoy"
                                "mimosa"
                                "BrookO"
                                "jeweledmonkey"
                                "LovelyLittleLovelies"
                                "shopmayapapaya"
                                "t8designs"
                                "thefancifulfeline"
                                "TheIntuitiveGarden"
                                "PoPkO"
                                "printaddictjapan"
                                "dragonladydesigns"
                                "MorganStreet"
                                "littleapplecrafts"
                                "MagdalenasAtelier"
                                "Midnightcreations"
                                "tofunkytown"
                                "inkpainter"
                                "ALLWILDJEWELS"
                                "HidenSeek"
                                "magicjelly"
                                "mamamonkey"
                                "MisNopalesArt"
                                "plumtickledfabrics"
                                "purposedesign"
                                "rienna"
                                "smeeta"
                                "southpacificbody"))

(defvar *quit-your-day-job* '("ageratum"
                              "arie1025"
                              "aromaticbodyoils"
                              "ashleyg"
                              "bonspielcreation"
                              "breadandbadger"
                              "chocolateandsteel"
                              "danitashop"
                              "dennisanderson"
                              "difart"
                              "downtothewiredesigns"
                              "essories"
                              "evert"
                              "fearlessfibers"
                              "geekcentralstation"
                              "gorjuss"
                              "ince1956"
                              "irenesuchocki"
                              "izer"
                              "katrinakaye"
                              "kittygrrlz"
                              "kittycrossbones"
                              "knittydirtygirl"
                              "lillyella"
                              "littleputbooks"
                              "mewpaperarts"
                              "miabeads"
                              "midnightcreations"
                              "muyinmolly"
                              "nderson"
                              "ome"
                              "piddix"
                              "rachelaustin"
                              "realisationcreations"
                              "reams"
                              "rganics"
                              "rooklyn"
                              "roselabiche"
                              "shadejewelry"
                              "spacedogstudios"
                              "sproutonline"
                              "sunnyrising"
                              "surly"
                              "thedreamygiraffe"
                              "thewren"
                              "ttic"
                              "weeones"))

(defun random-shop ()
  (let ((shops (concatenate 'list *high-volume-shops* *quit-your-day-job*)))
    (elt shops (random (length shops)))))

(defun report-on-high-volume-shops ()
  (loop for s in *high-volume-shops*
        do 
     (handler-case 
         (report-average-price s)
       (error (e) (format t "~& ~A  ~A" s e)))
     (sleep 0.1)))

(defun report-average-price (shop)
  (loop 
    with u = (first (memoize (get-user-details shop :detail-level :high)))
    finally 
 (cond
   ((zerop count)
    (format t "~& ~A no listings" shop))
   (t
    (let ((avg (/ (coerce sum 'float) count)))
      (format t "~&~A ~D ~6,2F ~S ~14,2F" shop count avg
              (slot-value u'etsy:transaction-sold-count)
              (* avg (slot-value u 'etsy:TRANSACTION-SOLD-COUNT))))))
    for x in (memoize (get-shop-listings shop :detail-level :medium :limit 50)) 
    sum (slot-value x 'etsy:price) into sum
    count x into count))

(defvar *selected-shops*
  '("Cathysjewels" "MagdalenasAtelier" "norah62" "robandlean" "elsiecake"
    "luxedeluxe" "TheBlackApple" "esdesigns" "fabricsupplies"
    "treehouse28" "matteart" "janinekingdesigns" "littleputbooks"
    "birdzNbeez" "Ahpeele" "toybreaker" "sudlow"
    "FromJapanWithLove" "Moop" "portobello" "cathydailey"
    "fabricworm" "pdxbeanies" "1ofmykind" "yadanabeads"
    "doubleangeldesign" "HomeStudio" "sfgirlbybay" "kittycrossbones"
    "SunAndMoonCraftKits" "circularaccessories" "t8designs" "imyourpresent"
    "thebeadyeye" "caughtredhanded" "LisasLovlies" "pomadour24"
    "palomasnest" "FearlessFibers" "tinymeat" "belleandboo"
    "Boojiboo" "pigeonroofstudios" "LillysBeadBox" "KathrynRiechert"
    "Lululalaland" "puffluna" "artfulmarket" "photoglassworks"))

